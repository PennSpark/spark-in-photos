let App,fetchAndUpload;_bb0‍.w("@slack/bolt",[["App",["App"],function(v){App=v}]]);_bb0‍.w("./upload",[["fetchAndUpload",["fetchAndUpload"],function(v){fetchAndUpload=v}]]);

require('dotenv').config()

const app = new App({
    token: process.env.BOT_TOKEN,
    appToken: process.env.APP_TOKEN,
    signingSecret: process.env.SIGNING_SECRET,
    socketMode: true
})

async function startApp() {
    // starts
    await app.start().catch(_bb0‍.g.console.error)
    // send start msg
    await app.client.chat.postMessage({
        token: process.env.BOT_TOKEN,
        channel: "C051TR8RS2U",
        text: "Bot has started >:)"
    })
    console.log("Bot has started.");
}

app.message(async ({ message }) => {
    if (message.files != null) {
        // gets url
        const data = message.files[0]
        const url = data.url_private
        const time = data.created
        const user = data.user

        fetchAndUpload(url)
        // creates user for auth purpose
        const auth = {
            'Authorization' : 'Bearer ' + process.env.BOT_TOKEN
        }
    } else {
        console.log("No file in message :(")
    }
})

startApp()